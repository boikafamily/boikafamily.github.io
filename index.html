<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í–∏—à–ª–∏—Å—Ç –ù–∞—Å—Ç–∏ –Ω–∞ 8-–ª–µ—Ç–∏–µ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #ffe6f0 0%, #fff0f9 100%);
            color: #333333;
            line-height: 1.6;
            padding: 12px;
            min-height: 100vh;
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
        }
        
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            opacity: 0.03;
            z-index: -1;
        }
        
        .container {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(233, 30, 99, 0.1);
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 182, 193, 0.3);
        }
        
        .header-content {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .photo-frame {
            width: 180px;
            height: 240px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 
                0 8px 20px rgba(233, 30, 99, 0.2),
                inset 0 0 0 3px white,
                inset 0 0 0 7px #ffb6c1;
            flex-shrink: 0;
            background-color: #fff9fb;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .photo-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .photo-frame img:hover {
            transform: scale(1.02);
        }
        
        .photo-placeholder {
            font-size: 3rem;
            color: #e91e63;
            display: none;
            z-index: 2;
        }
        
        .header-text {
            flex: 1;
            min-width: 250px;
        }
        
        h1 {
            color: #e91e63;
            margin-bottom: 12px;
            font-size: 2.2rem;
            text-shadow: 2px 2px 0px rgba(255, 255, 255, 0.8);
            position: relative;
            display: inline-block;
        }
        
        h1::after {
            content: "";
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #e91e63, #ffb6c1);
            border-radius: 5px;
        }
        
        h2 {
            color: #d81b60;
            margin: 20px 0 15px;
            padding-bottom: 10px;
            border-bottom: 2px dotted #ffcce0;
            font-size: 1.5rem;
        }
        
        .intro-text {
            font-size: 1.05rem;
            margin-bottom: 15px;
            color: #444;
            line-height: 1.7;
            background-color: rgba(255, 240, 245, 0.5);
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #ffb6c1;
        }
        
        .rules {
            background: linear-gradient(145deg, #fff5f9, #ffeef6);
            padding: 20px;
            border-radius: 15px;
            margin: 25px 0;
            border-left: 6px solid #ff99cc;
            box-shadow: 5px 5px 15px rgba(233, 30, 99, 0.08);
            position: relative;
            overflow: hidden;
        }
        
        .rules ol {
            margin-left: 24px;
            margin-top: 12px;
            color: #444;
            font-size: 1rem;
        }
        
        .rules li {
            margin-bottom: 12px;
        }
        
        /* –¢–∞–±–ª–∏—Ü–∞ */
        .gifts-table-wrapper {
            margin-top: 20px;
        }
        
        .gifts-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            box-shadow: 0 6px 16px rgba(233, 30, 99, 0.1);
            border-radius: 15px;
            overflow: hidden;
            background-color: white;
            border: 1px solid #ffe6ee;
        }
        
        .gifts-table th {
            background: #f8bbd0;
            color: #880e4f;
            padding: 12px 10px;
            text-align: left;
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .gifts-table td {
            padding: 12px 10px;
            border-bottom: 1px solid #f5f5f5;
            vertical-align: middle;
            font-size: 0.95rem;
            color: #333333;
        }
        
        .gifts-table tr:last-child td {
            border-bottom: none;
        }
        
        .gifts-table tr.booked-row {
            opacity: 0.75;
            color: #777777;
        }
        
        .gifts-table tr.booked-row strong {
            text-decoration: line-through;
            color: #777777;
        }
        
        .gifts-table tr.booked-row .btn {
            background: #f0f0f0 !important;
            color: #777777 !important;
            border: 1px solid #ddd !important;
            box-shadow: none !important;
        }
        
        .gifts-table tr.booked-row .btn-unbook {
            background: linear-gradient(135deg, #ffecb3, #ffd54f) !important;
            color: #e65100 !important;
            border: none !important;
            box-shadow: 0 3px 6px rgba(0,0,0,0.15) !important;
        }
        
        /* –ú–æ–±–∏–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ */
        .gifts-cards {
            display: none;
            margin-top: 20px;
            gap: 16px;
            flex-direction: column;
        }
        
        .gift-card {
            background: white;
            border-radius: 16px;
            padding: 16px;
            box-shadow: 0 5px 12px rgba(233, 30, 99, 0.1);
            border: 1px solid #ffe6ee;
            color: #333333;
        }
        
        .gift-card.booked {
            opacity: 0.75;
            color: #777777;
        }
        
        .gift-card.booked h3 {
            text-decoration: line-through;
            color: #777777 !important;
        }
        
        .gift-card.booked .btn {
            background: #f0f0f0 !important;
            color: #777777 !important;
            border: 1px solid #ddd !important;
            box-shadow: none !important;
        }
        
        .gift-card.booked .btn-unbook {
            background: linear-gradient(135deg, #ffecb3, #ffd54f) !important;
            color: #e65100 !important;
            border: none !important;
            box-shadow: 0 3px 6px rgba(0,0,0,0.15) !important;
        }
        
        .gift-card h3 {
            font-size: 1.1rem;
            margin-bottom: 8px;
            color: #d81b60;
        }
        
        .gift-card .comment {
            font-size: 0.9rem;
            color: #e91e63;
            font-style: italic;
            margin-bottom: 10px;
        }
        
        .gift-card .category {
            display: inline-block;
            padding: 4px 10px;
            background: #fce4ec;
            color: #880e4f;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 12px;
        }
        
        .gift-card .status {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 12px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }
        
        .status-free { background: #e8f5e9; color: #2e7d32; border: 1px solid #c8e6c9; }
        .status-booked { background: #f8bbd0; color: #880e4f; border: 1px solid #f48fb1; }
        
        .gift-card .btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .btn {
            padding: 8px 12px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .btn-preview { background: #e3f2fd; color: #0d47a1 !important; border: 1px solid #bbdefb; }
        .btn-reserve { background: #f8bbd0; color: #880e4f !important; border: 1px solid #f48fb1; }
        .btn-unbook { background: #ffecb3; color: #e65100 !important; border: 1px solid #ffd54f; }
        .btn-confirm { background: #c8e6c9; color: #1b5e20 !important; border: 1px solid #a5d6a7; }
        .btn-cancel { background: #eeeeee; color: #424242 !important; border: 1px solid #e0e0e0; }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.65);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal {
            background: white;
            border-radius: 20px;
            padding: 25px;
            width: 90%;
            max-width: 480px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            border: 2px solid #ffb6c1;
            text-align: center;
        }
        
        .modal h3 {
            color: #d81b60;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }
        
        .modal p {
            margin-bottom: 25px;
            color: #444444;
            font-size: 1.05rem;
            line-height: 1.6;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 15px;
            color: #d81b60;
            font-size: 0.95rem;
            border-top: 2px dashed #ffccd5;
        }
        
        .birthday-icon {
            position: absolute;
            font-size: 1.5rem;
            color: rgba(233, 30, 99, 0.15);
            z-index: -1;
        }
        
        .icon-1 { top: 5%; left: 5%; }
        .icon-2 { top: 10%; right: 10%; }
        .icon-3 { bottom: 15%; left: 8%; }
        .icon-4 { bottom: 20%; right: 5%; }
        
        #custom-notification {
            position: fixed;
            top: 12px;
            right: 12px;
            padding: 10px 18px;
            border-radius: 12px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
            z-index: 10000;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            transform: translateX(150%);
            transition: transform 0.5s ease;
            max-width: 320px;
            font-size: 0.9rem;
            color: #333333;
        }
        
        @media (max-width: 900px) {
            .header-content { justify-content: center; text-align: center; }
            .header-text h1::after { left: 50%; transform: translateX(-50%); width: 80%; }
        }
        
        @media (max-width: 768px) {
            .gifts-table-wrapper { display: none; }
            .gifts-cards { display: flex; }
            .container { padding: 20px; }
            h1 { font-size: 2rem; }
            .photo-frame { width: 150px; height: 200px; }
            .btn { padding: 7px 10px; font-size: 0.85rem; }
            .birthday-icon { display: none; }
        }
        
        @media (max-width: 480px) {
            .photo-frame { width: 130px; height: 170px; border-radius: 12px; }
            .header-content { flex-direction: column; text-align: center; gap: 15px; }
            h1 { font-size: 1.8rem; }
            .intro-text { font-size: 0.95rem; }
            .btn { padding: 6px 9px; font-size: 0.8rem; }
        }
    </style>
</head>
<body>
    <div class="birthday-icon icon-1">üéÄ</div>
    <div class="birthday-icon icon-2">üéà</div>
    <div class="birthday-icon icon-3">üéÅ</div>
    <div class="birthday-icon icon-4">ü¶Ñ</div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div class="modal-overlay" id="confirm-reserve-modal">
        <div class="modal">
            <h3>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ?</h3>
            <p id="confirm-reserve-text">–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø–æ–¥–∞—Ä–æ–∫?</p>
            <div class="modal-buttons">
                <button class="btn btn-cancel" id="cancel-reserve">–û—Ç–º–µ–Ω–∏—Ç—å</button>
                <button class="btn btn-confirm" id="confirm-reserve">–î–∞, –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="unbook-modal">
        <div class="modal">
            <h3>–û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ?</h3>
            <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞? –ü–æ—Å–ª–µ –æ—Ç–º–µ–Ω—ã –æ–Ω —Å–Ω–æ–≤–∞ —Å—Ç–∞–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –¥—Ä—É–≥–∏—Ö –≥–æ—Å—Ç–µ–π.</p>
            <div class="modal-buttons">
                <button class="btn btn-cancel" id="cancel-unbook">–ù–µ—Ç, –æ—Å—Ç–∞–≤–∏—Ç—å</button>
                <button class="btn btn-unbook" id="confirm-unbook">–î–∞, –æ—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <header>
            <div class="header-content">
                <div class="photo-frame">
                    <img src="./IMG_5643.jpg" alt="–ù–∞—Å—Ç—è, –∏–º–µ–Ω–∏–Ω–Ω–∏—Ü–∞" id="nastya-photo" onerror="showPlaceholder()">
                    <div class="photo-placeholder" id="photo-placeholder"><i class="fas fa-birthday-cake"></i></div>
                </div>
                <div class="header-text">
                    <h1><i class="fas fa-birthday-cake"></i> –í–∏—à–ª–∏—Å—Ç –ù–∞—Å—Ç–∏ –Ω–∞ 8-–ª–µ—Ç–∏–µ</h1>
                    <div class="intro-text">
                        –ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ –Ø - –ù–∞—Å—Ç—è, –∏ —è –æ—á–µ–Ω—å —Ä–∞–¥–∞, —á—Ç–æ —Ç—ã –ø—Ä–∏–¥—ë—à—å –∫–æ –º–Ω–µ –Ω–∞ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è!<br>
                        –ú–Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è —É–∂–µ 8 –ª–µ—Ç, –∏ –∑–¥–æ—Ä–æ–≤–æ, —á—Ç–æ –º—ã –æ—Ç–º–µ—Ç–∏–º —ç—Ç–æ—Ç –ø—Ä–∞–∑–¥–Ω–∏–∫ –≤–º–µ—Å—Ç–µ.
                    </div>
                    <div class="intro-text">
                        –ù–∏–∂–µ ‚Äî –º–æ–π —Å–ø–∏—Å–æ–∫ —Ö–æ—Ç–µ–ª–æ–∫. –í—ã–±–∏—Ä–∞–π, —á—Ç–æ —Ç–µ–±–µ –ø–æ –¥—É—à–µ!<br>
                        –ù–æ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–º–Ω–∏: –¥–∞—Ä–∏—Ç—å —á—Ç–æ-—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞ —Å–æ–≤—Å–µ–º –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.<br>
                        <strong>–ì–ª–∞–≤–Ω–æ–µ ‚Äî —Ç–≤–æ—ë –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ!</strong>
                    </div>
                </div>
            </div>
        </header>
        
        <section class="rules">
            <h2><i class="fas fa-info-circle"></i> –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</h2>
            <ol>
                <li>–ù–∞–∂–º–∏ ¬´–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å¬ª, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–¥–∞—Ä–æ–∫ –Ω–∞ Wildberries.</li>
                <li>–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –µ–≥–æ –ø–æ–¥–∞—Ä–∏—Ç—å ‚Äî –Ω–∞–∂–º–∏ ¬´–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å¬ª.</li>
                <li>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –æ–∫–Ω–µ.</li>
                <li>–ï—Å–ª–∏ –ø–µ—Ä–µ–¥—É–º–∞–µ—à—å ‚Äî –Ω–∞–∂–º–∏ ¬´–û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω—å¬ª.</li>
                <li>–≠—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ ‚Äî —Ç–æ–ª—å–∫–æ –∏–¥–µ–∏. –ì–ª–∞–≤–Ω–æ–µ ‚Äî —Ç—ã —Å–∞–º(–∞)! ‚ù§Ô∏è</li>
            </ol>
        </section>
        
        <section>
            <h2><i class="fas fa-gifts"></i> –°–ø–∏—Å–æ–∫ –ø–æ–¥–∞—Ä–∫–æ–≤</h2>
            <div class="gifts-table-wrapper">
                <table class="gifts-table">
                    <thead><tr><th>‚Ññ</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th><th>–°—Å—ã–ª–∫–∞</th><th>–°—Ç–∞—Ç—É—Å</th></tr></thead>
                    <tbody id="gifts-table-body"></tbody>
                </table>
            </div>
            <div class="gifts-cards" id="gifts-cards-container"></div>
        </section>
        
        <footer>
            –°–ø–∞—Å–∏–±–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç–µ –º–æ–π –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è –æ—Å–æ–±–µ–Ω–Ω—ã–º! <i class="fas fa-heart" style="color: #e91e63;"></i>
        </footer>
    </div>
    
    <script>
        // === –¢–í–û–Ø –°–°–´–õ–ö–ê –ù–ê GOOGLE APPS SCRIPT ===
        const BACKEND_URL = "https://script.google.com/macros/s/AKfycbyhuSucu26XQ1LSXbOChGYeNKF3tMl8XaEBMZcmbiFFO0msBl9nb2ZmuWEy-o9juK8C7Q/exec";

        // –ò—Å—Ö–æ–¥–Ω—ã–π —Å–ø–∏—Å–æ–∫ (–¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è, –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
        const initialGifts = [
            { id: 1, name: "–ü–∏–∂–∞–º–∞ –¥–ª—è –¥–µ–≤–æ—á–∫–∏ —Å–æ —à—Ç–∞–Ω–∞–º–∏", category: "–û–¥–µ–∂–¥–∞", link: "https://www.wildberries.by/catalog/446793216/detail.aspx?size=631539819", comment: "–†–æ—Å—Ç 135-145" },
            { id: 2, name: "–ö–∏–≥—É—Ä—É–º–∏ –ü–∏–∫–∞—á—É- –ü–∏–∂–∞–º–∞ –î–ª—è –î–æ–º–∞", category: "–û–¥–µ–∂–¥–∞", link: "https://www.wildberries.by/catalog/177554973/detail.aspx?size=293993230", comment: "–†–æ—Å—Ç 140" },
            { id: 3, name: "–¢–∞–ø–æ—á–∫–∏ –¥–æ–º–∞—à–Ω–∏–µ –∫–∏–≥—É—Ä—É–º–∏ –ü–∏–∫–∞—á—É", category: "–û–¥–µ–∂–¥–∞", link: "https://www.wildberries.by/catalog/134246810/detail.aspx?size=230177738", comment: "35-38" },
            { id: 4, name: "–ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –∏–≥—Ä–∞ –°–ª–æ–≤–æ–¥–µ–ª –í–µ–ª–∏–∫–∞–Ω", category: "–ò–≥—Ä—ã", link: "https://www.wildberries.by/catalog/374826/detail.aspx?size=1679515", comment: "" },
            { id: 5, name: "–ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –∏–≥—Ä–∞ –í–ª–∞—Å—Ç–µ–ª–∏–Ω —Å–ª–æ–≤", category: "–ò–≥—Ä—ã", link: "https://www.wildberries.by/catalog/288097336/detail.aspx?size=440248049", comment: "" },
            { id: 6, name: "–ù–∞–±–æ—Ä –¥–ª—è –æ–ø—ã—Ç–æ–≤ –∏ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞ –ó–µ–ª—å–µ", category: "–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ", link: "https://www.wildberries.by/catalog/436264576/detail.aspx?size=618930955", comment: "" },
            { id: 7, name: "–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ã–π –º–∏–Ω–∏ –ø—Ä–∏–Ω—Ç–µ—Ä –¥–ª—è –Ω–∞–∫–ª–µ–µ–∫ –∏ —Ñ–æ—Ç–æ", category: "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", link: "https://www.wildberries.by/catalog/202653223/detail.aspx?size=326729613", comment: "" },
            { id: 8, name: "–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ä—É—á–µ–∫ –¥–ª—è –¥–µ—Ç–µ–π", category: "–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ", link: "https://www.wildberries.by/catalog/486210468/detail.aspx?size=678077181", comment: "" },
            { id: 9, name: "–ö–Ω–∏–≥–∞ –∏–Ω—Ç–µ—Ä–≤—å—é –∞–Ω–∫–µ—Ç–∞ –¥–ª—è –¥–µ–≤–æ—á–µ–∫ –∏ –º–∞–ª—å—á–∏–∫–æ–≤", category: "–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ", link: "https://www.wildberries.by/catalog/15473870/detail.aspx?size=44937170", comment: "" },
            { id: 10, name: "–ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –∏–≥—Ä–∞ –ß—Ç–æ –∑–∞ —Ç—Ä–µ–∫: –í–µ—á–Ω—ã–µ –•–∏—Ç—ã", category: "–ò–≥—Ä—ã", link: "https://www.wildberries.by/catalog/344230530/detail.aspx?size=511584735", comment: "" },
            { id: 11, name: "–ü–æ–¥–∞—Ä–æ–∫ –¥–µ–≤–æ—á–∫–µ —Å–æ–∑–¥–∞–π —á–∞—Å—ã", category: "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", link: "https://www.wildberries.by/catalog/234551397/detail.aspx?targetUrl=EX", comment: "" }
        ];

        let gifts = [...initialGifts];
        let giftToReserve = null;
        let giftToUnbook = null;

        // DOM
        const tableBody = document.getElementById('gifts-table-body');
        const cardsContainer = document.getElementById('gifts-cards-container');
        const confirmReserveModal = document.getElementById('confirm-reserve-modal');
        const unbookModal = document.getElementById('unbook-modal');

        // === –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• –ò–ó GOOGLE –¢–ê–ë–õ–ò–¶–´ ===
        async function loadFromServer() {
            try {
                const response = await fetch(BACKEND_URL);
                if (!response.ok) throw new Error("–°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç");
                const serverData = await response.json();

                // –û–±—ä–µ–¥–∏–Ω—è–µ–º: –∏–º—è, –∫–∞—Ç–µ–≥–æ—Ä–∏—è ‚Äî –∏–∑ initialGifts, —Å—Ç–∞—Ç—É—Å ‚Äî –∏–∑ —Å–µ—Ä–≤–µ—Ä–∞
                gifts = gifts.map(gift => {
                    const serverItem = serverData.find(item => item.id == gift.id);
                    return {
                        ...gift,
                        status: serverItem?.status || 'free'
                    };
                });

                render();
            } catch (error) {
                console.warn("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞:", error);
                render(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            }
        }

        // === –û–¢–ü–†–ê–í–ö–ê –°–¢–ê–¢–£–°–ê –ù–ê –°–ï–†–í–ï–† ===
        async function updateStatus(id, status) {
            try {
                const response = await fetch(BACKEND_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id, status })
                });
                if (!response.ok) throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å");
                await loadFromServer(); // –û–±–Ω–æ–≤–ª—è–µ–º –≤–µ—Å—å —Å–ø–∏—Å–æ–∫
            } catch (error) {
                alert("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.");
                console.error(error);
            }
        }

        // === –û–°–¢–ê–õ–¨–ù–û–ô –ö–û–î –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô ===
        function showPlaceholder() {
            document.getElementById('nastya-photo').style.display = 'none';
            document.getElementById('photo-placeholder').style.display = 'block';
        }

        function getStatusBadge(status) {
            if (status === 'booked') {
                return '<span class="status status-booked">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ</span>';
            }
            return '<span class="status status-free">–°–≤–æ–±–æ–¥–Ω–æ</span>';
        }

        function getActionButtons(gift) {
            if (gift.status === 'free') {
                return `
                    <button class="btn btn-preview" onclick="window.open('${gift.link.trim()}', '_blank')">
                        <i class="fas fa-external-link-alt"></i> –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å
                    </button>
                    <button class="btn btn-reserve" onclick="openReserveModal(${gift.id})">
                        <i class="fas fa-gift"></i> –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å
                    </button>`;
            } else {
                return `
                    <button class="btn btn-preview" onclick="window.open('${gift.link.trim()}', '_blank')">
                        <i class="fas fa-external-link-alt"></i> –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å
                    </button>
                    <button class="btn btn-unbook" onclick="openUnbookModal(${gift.id})">
                        <i class="fas fa-undo"></i> –û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω—å
                    </button>`;
            }
        }

        function renderTable() {
            tableBody.innerHTML = '';
            gifts.forEach(gift => {
                const commentHtml = gift.comment ? `<div class="comment">${gift.comment}</div>` : '';
                const row = document.createElement('tr');
                if (gift.status === 'booked') row.classList.add('booked-row');
                row.innerHTML = `
                    <td>${gift.id}</td>
                    <td><strong>${gift.name}</strong>${commentHtml}</td>
                    <td><span class="category">${gift.category}</span></td>
                    <td>${getActionButtons(gift)}</td>
                    <td>${getStatusBadge(gift.status)}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        function renderCards() {
            cardsContainer.innerHTML = '';
            gifts.forEach(gift => {
                const commentHtml = gift.comment ? `<div class="comment">${gift.comment}</div>` : '';
                const card = document.createElement('div');
                card.className = `gift-card ${gift.status === 'booked' ? 'booked' : ''}`;
                card.innerHTML = `
                    <h3>${gift.name}</h3>
                    ${commentHtml}
                    <div class="category">${gift.category}</div>
                    ${getStatusBadge(gift.status)}
                    <div class="btn-group">${getActionButtons(gift)}</div>
                `;
                cardsContainer.appendChild(card);
            });
        }

        function render() {
            renderTable();
            renderCards();
        }

        function openReserveModal(id) {
            const gift = gifts.find(g => g.id === id);
            if (gift && gift.status === 'free') {
                giftToReserve = id;
                document.getElementById('confirm-reserve-text').textContent = `–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å ¬´${gift.name}¬ª?`;
                confirmReserveModal.style.display = 'flex';
            }
        }

        document.getElementById('confirm-reserve').addEventListener('click', () => {
            if (giftToReserve !== null) {
                updateStatus(giftToReserve, 'booked');
                showNotification('–ü–æ–¥–∞—Ä–æ–∫ —É—Å–ø–µ—à–Ω–æ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω! –°–ø–∞—Å–∏–±–æ!', 'success');
                confirmReserveModal.style.display = 'none';
                giftToReserve = null;
            }
        });

        document.getElementById('cancel-reserve').onclick = () => {
            confirmReserveModal.style.display = 'none';
            giftToReserve = null;
        };

        function openUnbookModal(id) {
            giftToUnbook = id;
            unbookModal.style.display = 'flex';
        }

        document.getElementById('confirm-unbook').addEventListener('click', () => {
            if (giftToUnbook !== null) {
                updateStatus(giftToUnbook, 'free');
                showNotification('–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ! –ü–æ–¥–∞—Ä–æ–∫ —Å–Ω–æ–≤–∞ –¥–æ—Å—Ç—É–ø–µ–Ω.', 'info');
                unbookModal.style.display = 'none';
                giftToUnbook = null;
            }
        });

        document.getElementById('cancel-unbook').onclick = () => {
            unbookModal.style.display = 'none';
            giftToUnbook = null;
        };

        function showNotification(message, type) {
            let n = document.getElementById('custom-notification');
            if (!n) {
                n = document.createElement('div');
                n.id = 'custom-notification';
                document.body.appendChild(n);
            }
            const cfg = {
                success: { bg: '#c8e6c9', color: '#1b5e20', icon: 'check-circle' },
                info: { bg: '#fff3e0', color: '#e65100', icon: 'info-circle' }
            }[type] || { bg: '#ffcdd2', color: '#b71c1c', icon: 'exclamation-circle' };
            n.style.background = cfg.bg;
            n.style.color = cfg.color;
            n.innerHTML = `<i class="fas fa-${cfg.icon}"></i> ${message}`;
            n.style.transform = 'translateX(0)';
            setTimeout(() => n.style.transform = 'translateX(150%)', 3000);
        }

        window.onclick = (e) => {
            if (e.target === confirmReserveModal) {
                confirmReserveModal.style.display = 'none';
                giftToReserve = null;
            }
            if (e.target === unbookModal) {
                unbookModal.style.display = 'none';
                giftToUnbook = null;
            }
        };

        // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===
        document.addEventListener('DOMContentLoaded', () => {
            loadFromServer(); // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞

            const photo = document.getElementById('nastya-photo');
            photo.onerror = showPlaceholder;
            setTimeout(() => {
                if (photo.complete && photo.naturalHeight === 0) showPlaceholder();
            }, 2000);
        });
    </script>
</body>
</html>
